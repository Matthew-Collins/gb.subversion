' Gambas class file

Static Public Function Setup_Settings(StartFromScratch As Boolean) As Repository

  If StartFromScratch Then
    Print "Warning: Clearing All Settings"
    Settings.Clear
  Endif

End

Static Public Sub Main()

  Dim Root As New RecentRoot
  Dim Recent As Recent

  Setup_Settings(True)

  Root.LoadRecentUrlsAndWorkingDirectories

  Assert.Section = "Recent"
  Assert.Test = "Test_001_Load_And_Save_Recent_Urls"

  Assert.Part = "CleanUp"
  Assert.IsExpected(Root.List.Count, 0, "Initial Number of Recent Not Zero")

  Root.AddNewRecentItem("https://github.com/Matthew-Collins/gb.subversion/trunk", "/home/matthew/Documents/gb.subversion")
  Root.AddNewRecentItem("https://github.com/Matthew-Collins/gb.PiconZero/trunk", "/home/matthew/Documents/gb.PiconZero")
  Root.AddNewRecentItem("https://github.com/Matthew-Collins/gb.subversion/trunk", "/home/matthew/Documents/gb.subversion")
  Root.AddNewRecentItem("https://github.com/Matthew-Collins/gb.PiconZero/trunk", "/home/matthew/Documents/gb.PiconZero")

  Root.SaveRecentUrlsAndWorkingDirectories()

  Root = New RecentRoot
  Root.LoadRecentUrlsAndWorkingDirectories

  Assert.IsExpected(Root.List.Count, 2, "Recent Item Not Saved")

End
