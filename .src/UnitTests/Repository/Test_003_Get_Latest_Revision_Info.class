' Gambas class file

Static Public Function Setup_Repository() As Repository

  Dim RepositoryPath As String = "/tmp/.testing/Repository/Local Test 003"
  Dim RepositoryUrl As String = "file:///tmp/.testing/Repository/Local Test 003"
  Dim WorkingDirectoryPath As String = "/tmp/.testing/WorkingDirectory/Local Test 003"
  Dim Repository As New Repository(RepositoryUrl, RepositoryPath)
  Dim WorkingDirectory As New WorkingDirectory(WorkingDirectoryPath)

  Directory.DeleteDirectory(RepositoryPath)
  Directory.DeleteDirectory(WorkingDirectoryPath)
  Repository.CreateLocalRepository()
  Repository.CheckOut(WorkingDirectory)

  Return Repository

End

Static Public Sub Main()

  Dim Repository As Repository = Setup_Repository()

  Repository.Load_Subversion_Repository_Latest_Status("", "")

  Assert.Section = "Repository"
  Assert.Test = "Test_003_Get_Latest_Revision_Info"
  Assert.IsExpected(Repository.Revision, 0, "Initial Revision Incorrect")

End
