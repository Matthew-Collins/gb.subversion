' Gambas class file

Static Public Sub Main()

  Dim UserName As String = "Joe.Bloggs@Bloggs.Inc"
  Dim Password As String = "MyPassword"

  Dim Store1 As New Credentials
  Dim Actual1 As Credential = Store1.Add(UserName, Password)

  Assert.Section = "Credentials"
  Assert.Test = Class(Me).Name

  If Assert.IsNotNull(Actual1, "No Id Returned Therefore Not Saved")
    Assert.IsTrue(Actual1.Id > 0, "Credential Id Not Greater Than Zero")

    Dim Store2 As New Credentials
    Dim Actual2 As Credential = Store2.Get(Actual1.id)

    If Assert.IsNotNull(actual2, "No Crendetial Returned Therefore Not Saved")
      Assert.IsExpected(actual2.Id, actual1.Id, "Saved and Retreived Ids Do Not Match")
    End If

  End If

End
