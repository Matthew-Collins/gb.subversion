' Gambas class file

Public IsCancelled As Boolean = True

Public SiteUrl As String

Public Sub _new(ToSiteUrl As String)

  Me.SiteUrl = ToSiteUrl
  UserName.Text = Settings[SiteUrl & "/UserName", ""]
  Password.Text = Settings[SiteUrl & "/Password", ""]

End

Public Sub ShowIfRequired()

  If UserName.text And If Password.text Then
    Me.IsCancelled = False
  Else
    Me.ShowDialog
  Endif

End

Public Sub ShowPassword_Click()

  Password.Password = Not ShowPassword.Value

End

Public Sub ButtonOk_Click()

  Settings[SiteUrl & "/UserName"] = UserName.Text
  If RememberPassword.Value Then
    Settings[SiteUrl & "/Password"] = Password.Text
  Endif

  Me.IsCancelled = False
  Me.Close

End

Public Sub ButtonCancel_Click()

  Me.Close

End
