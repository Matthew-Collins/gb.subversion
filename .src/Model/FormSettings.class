' Gambas class file

Const SettingName As String = ".Window/"

Static Public Sub ApplySavedLocationAndSize(View As Form)

  View.Left = Settings[View.Name & SettingName & "Left", View.Left]
  View.Top = Settings[View.Name & SettingName & "Top", View.Top]
  View.Width = Settings[View.Name & SettingName & "Width", View.Width]
  View.Height = Settings[View.Name & SettingName & "Height", View.Height]
  View.Maximized = Settings[View.Name & SettingName & "Maximized", False]

End Sub

Static Public Sub SaveLocationAndSize(View As Form)

  If View.Maximized Then
    Settings[View.Name & SettingName & "Maximized"] = True
  Else If View.Minimized Then
    Settings[View.Name & SettingName & "Maximized"] = False
  Else
    Settings[View.Name & SettingName & "Maximized"] = False
    Settings[View.Name & SettingName & "Left"] = View.Left
    Settings[View.Name & SettingName & "Top"] = View.Top
    Settings[View.Name & SettingName & "Width"] = View.Width
    Settings[View.Name & SettingName & "Height"] = View.Height
  Endif

End Sub
